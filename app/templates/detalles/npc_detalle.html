{% extends "layout/base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/detalle.css">
{% endblock %}

{% block content %}

<div class="detalle-container">

    <div class="detalle-info">
        <h1 class="detalle-titulo">{{ npc.nombre }}</h1>

        <p class="detalle-descripcion">
            {{ npc.descripcion }}
        </p>
        <div class="acciones-npc">
            <button class="btn-accion" onclick="window.location.href='/npcs/{{ npc.id }}/editar'">
                ‚öô Ajustar NPC
            </button>

            <button class="btn-accion btn-danger" onclick="window.location.href='/npcs/{{ npc.id }}/eliminar'">
                üóë Borrar NPC
             </button>

            {% if npc.tipo == "vendedor" %}
                 <button class="btn-accion" onclick="window.location.href='/items/crear?npc_id={{ npc.id }}'">
                    ‚ûï A√±adir Objeto
                 </button>
            {% endif %}

            {% if npc.tipo == "misiones" %}
                <button class="btn-accion" onclick="window.location.href='/misiones/crear?npc_id={{ npc.id }}'">
                    ‚ûï A√±adir Misi√≥n
                </button>
            {% endif %}

        </div>

        {% if npc.tipo == "vendedor" and items %}
        <h2 class="subtitulo">√çtems que vende</h2>
        <div class="lista-secundaria">
            {% for i in items %}
                <div class="item-card" onclick="window.location.href='/items/{{ i.id }}'">
                    <img src="{{ i.imagen_url }}" alt="{{ i.nombre }}">
                    <p>{{ i.nombre }}</p>
                </div>
            {% endfor %}
        </div>
        {% endif %}

        {% if npc.tipo == "misiones" and misiones %}
        <h2 class="subtitulo">Misiones asociadas</h2>
        <div class="lista-secundaria">
            {% for m in misiones %}
                <div class="item-card" onclick="window.location.href='/misiones/{{ m.id }}'">
                    <img src="https://azbsgiuhvkwmpeiwrwdd.supabase.co/storage/v1/object/public/npc_imagenes/public/mision_icon.png">
                    <p>{{ m.titulo }}</p>
                </div>
            {% endfor %}
        </div>
        {% endif %}

    </div>

    <div class="detalle-imagen">
        <img src="{{ npc.imagen_url }}" alt="{{ npc.nombre }}">
    </div>

</div>

{% endblock %}
